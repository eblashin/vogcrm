&НаКлиенте
Процедура КомандаВыбрать(Команда)
	
	Список = "";
	
	ПредставлениеСписка = "";
	
	Массив = СписокЭлементов.ВыгрузитьЗначения();	
	
	ТекущийИндекс = 0; 
	ВсегоЭлементов = Массив.Количество(); 
	Пока ТекущийИндекс < ВсегоЭлементов Цикл 
		Индекс2 = ТекущийИндекс + 1; 
		Пока Индекс2 < ВсегоЭлементов Цикл 
			Если Массив[Индекс2] = Массив[ТекущийИндекс] Тогда 
				Массив.Удалить(Индекс2); 
				ВсегоЭлементов = ВсегоЭлементов - 1; 
			Иначе 
				Индекс2 = Индекс2 + 1; 
			КонецЕсли; 
		КонецЦикла; 
		ТекущийИндекс = ТекущийИндекс + 1; 
	КонецЦикла; 	
	
	СписокЭлементов.ЗагрузитьЗначения(Массив);
	СписокЭлементов.СортироватьПоЗначению();	
	
	Для Каждого ЭлементСписка из СписокЭлементов цикл
		Если НЕ ЭлементСписка.Значение.Пустая() тогда
			Список = Список + ЭлементСписка.Значение.УникальныйИдентификатор() +"; ";
			ПредставлениеСписка = ПредставлениеСписка + СокрЛП(ЭлементСписка.Значение) + "; ";
		КонецЕсли;		
	КонецЦикла;
	
	СтруктураВозврата = Новый Структура("Список, ПредставлениеСписка");
	
	СтруктураВозврата.Список = Список;
	СтруктураВозврата.ПредставлениеСписка = ПредставлениеСписка;
	
	ОповеститьОВыборе(СтруктураВозврата);
	
КонецПроцедуры

&НаКлиенте
Процедура КомандаОтменитьВыбор(Команда)
	ОповеститьОВыборе("Неопределено")
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	СписокЭлементов.ТипЗначения = Новый ОписаниеТипов("СправочникСсылка."+Параметры.ТипСписка);
	
	МассивЭлементов = СтрРазделить(Параметры.Список,"; ");
	Для каждого ЭлементМассива ИЗ МассивЭлементов цикл
		Если СокрЛП(ЭлементМассива) <> "" тогда
			СписокЭлементов.Добавить(Справочники[Параметры.ТипСписка].ПолучитьСсылку(Новый УникальныйИдентификатор(ЭлементМассива)));	
		КонецЕсли;	
	КонецЦикла;	
		
КонецПроцедуры
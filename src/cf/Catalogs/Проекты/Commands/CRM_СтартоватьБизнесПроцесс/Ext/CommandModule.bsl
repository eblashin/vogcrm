
&НаСервере
Функция ПроверитьПараметрКоманды(ПараметрКоманды)
	
	Если ОбщегоНазначения.ЭтоСсылка(ТипЗнч(ПараметрКоманды)) Тогда
		Возврат НЕ ПараметрКоманды.ЭтоГруппа И ЗначениеЗаполнено(ПараметрКоманды.CRM_КартаМаршрута);
	Иначе
		Возврат Ложь;
	КонецЕсли;
	
КонецФункции

&НаСервере
Функция ЭтоНезависимыйПроцесс(Процесс)
	
	Возврат (Процесс.bpmТипПроцесса = Перечисления.bpmТипыПроцессов.НезависимыйПроцесс);
	
КонецФункции

&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	Если ПроверитьПараметрКоманды(ПараметрКоманды) Тогда
		ПараметрыФормы = Новый Структура("Основание", ПараметрКоманды);
		
		Если ЭтоНезависимыйПроцесс(ПараметрКоманды) Тогда
			ОткрытьФорму("БизнесПроцесс.CRM_БизнесПроцесс.Форма.ФормаСтартаНезависимого", ПараметрыФормы, ПараметрыВыполненияКоманды.Источник,,,,,РежимОткрытияОкнаФормы.БлокироватьОкноВладельца);
		Иначе
			ОткрытьФорму("БизнесПроцесс.CRM_БизнесПроцесс.ФормаОбъекта",ПараметрыФормы, ПараметрыВыполненияКоманды.Источник);
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

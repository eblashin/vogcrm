
#Область ОбработчикиСобытийФормы

&НаСервере
// Процедура - обработчик события ПриСозданииНаСервере.
//
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
		
	// СтандартныеПодсистемы.ПодключаемыеКоманды
	ПодключаемыеКоманды.ПриСозданииНаСервере(ЭтотОбъект);
	// Конец СтандартныеПодсистемы.ПодключаемыеКоманды
	
КонецПроцедуры // ПриСозданииНаСервере()

#КонецОбласти

#Область ОбработчикиКомандФормы

// СтандартныеПодсистемы.ПодключаемыеКоманды
&НаКлиенте
Процедура Подключаемый_ВыполнитьКоманду(Команда)
    ПодключаемыеКомандыКлиент.ВыполнитьКоманду(ЭтотОбъект, Команда, Элементы.Список);
КонецПроцедуры

&НаСервере
Процедура Подключаемый_ВыполнитьКомандуНаСервере(Контекст, Результат)
    ПодключаемыеКоманды.ВыполнитьКоманду(ЭтотОбъект, Контекст, Элементы.Список, Результат);
КонецПроцедуры

&НаКлиенте
Процедура Подключаемый_ОбновитьКоманды()
    ПодключаемыеКомандыКлиентСервер.ОбновитьКоманды(ЭтотОбъект, Элементы.Список);
КонецПроцедуры
// Конец СтандартныеПодсистемы.ПодключаемыеКоманды


&НаКлиенте
Процедура КомандаСоздатьВоронку(Команда)
	Форма = ПолучитьФорму("Справочник.CRM_ВоронкиПродаж.ФормаОбъекта", Новый Структура("ЗначенияЗаполнения", Новый Структура()), Элементы.Список);
	Если Форма <> Неопределено Тогда
		Форма.Открыть();
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура КомандаСоздатьЭтап(Команда)
	ТекРодитель = Элементы.Список.ТекущийРодитель;
	Если Не ЗначениеЗаполнено(ТекРодитель) Тогда
		Если Элементы.Список.ТекущиеДанные <> Неопределено И Не ЗначениеЗаполнено(Элементы.Список.ТекущиеДанные.Родитель) Тогда
			ТекРодитель = Элементы.Список.ТекущиеДанные.Ссылка;
		КонецЕсли;
	КонецЕсли;
	
	Если ЗначениеЗаполнено(ТекРодитель) Тогда
		ПараметрыСтруктура = Новый Структура("ЗначенияЗаполнения", Новый Структура("Родитель", ТекРодитель));
	Иначе
		ПараметрыСтруктура = Новый Структура("ЗначенияЗаполнения", Новый Структура("Родитель"));
	КонецЕсли;
	Форма = ПолучитьФорму("Справочник.CRM_ВоронкиПродаж.ФормаОбъекта", ПараметрыСтруктура, Элементы.Список);
	Если Форма <> Неопределено Тогда
		Форма.Открыть();
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура ПроверкаЭтаповВоронок(Команда)
	ПараметрКоманды = Новый Массив;
	ПараметрКоманды.Добавить(Элементы.Список.ТекущиеДанные.Ссылка);
	ПараметрыВыполненияКоманды = Новый Структура;
	ПараметрыВыполненияКоманды.Вставить("Источник",		ЭтотОбъект);
	ПараметрыВыполненияКоманды.Вставить("Окно",			Неопределено);
	ПараметрыВыполненияКоманды.Вставить("Уникальность",	Ложь);
	УправлениеПечатьюКлиент.ВыполнитьКомандуПечати("Справочник.CRM_ВоронкиПродаж", "ПроверкаВоронокПродаж", 
		ПараметрКоманды, ПараметрыВыполненияКоманды.Источник);
КонецПроцедуры

#КонецОбласти

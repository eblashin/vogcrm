

#Область СлужебныеПроцедурыИФункции

Процедура ОбновитьРасшифровкиСтатусов() Экспорт
	
	Для каждого МетаМакет из Метаданные.РегистрыСведений.CRM_РасшифровкиСтатусовПисемEmailРассылки.Макеты Цикл
		
		Макет = РегистрыСведений.CRM_РасшифровкиСтатусовПисемEmailРассылки.ПолучитьМакет(МетаМакет.Имя);
		НомерСтроки = 1;
		Пока Истина Цикл
			
			НомерСтроки = НомерСтроки + 1;
			Если СокрЛП(Макет.Область(НомерСтроки,1).Текст) = "" Тогда
				Прервать;
			КонецЕсли;
			КодСтатуса	= СокрЛП(Макет.Область(НомерСтроки,1).Текст);
			Расшифровка	= СокрЛП(Макет.Область(НомерСтроки,2).Текст);
			
			МенеджерЗаписи = РегистрыСведений.CRM_РасшифровкиСтатусовПисемEmailРассылки.СоздатьМенеджерЗаписи();
			МенеджерЗаписи.КодСтатуса = КодСтатуса;
			МенеджерЗаписи.Прочитать();
			Если МенеджерЗаписи.Расшифровка<>Расшифровка Тогда
				МенеджерЗаписи.КодСтатуса = КодСтатуса;
				МенеджерЗаписи.Расшифровка = Расшифровка;
				МенеджерЗаписи.Записать();
			КонецЕсли;
			
		КонецЦикла;
		
	КонецЦикла;
	
КонецПроцедуры

#КонецОбласти

&НаСервере
// Процедура заполняет доступные типы макетов.
//
// Параметры:
//	Нет.
//
Процедура ПолучитьДоступныеТипы()
	
	// +CRM не переносить в объединенные решения
	СписокДокументов.Добавить(Метаданные.Документы.CRM_СчетНаОплатуПокупателю.ПолноеИмя(), Метаданные.Документы.CRM_СчетНаОплатуПокупателю.Представление(), , БиблиотекаКартинок.Документ);
	// -CRM не переносить в объединенные решения
	СписокДокументов.Добавить(Метаданные.Документы.КоммерческоеПредложениеКлиенту.ПолноеИмя(), Метаданные.Документы.КоммерческоеПредложениеКлиенту.Представление(), , БиблиотекаКартинок.Документ);
	// + СК
	СписокДокументов.Добавить(Метаданные.Справочники.ДоговорыКонтрагентов.ПолноеИмя(), Метаданные.Справочники.ДоговорыКонтрагентов.Представление(), , БиблиотекаКартинок.Справочник);
	// - СК
	//START Кайдашов 02/07/19	
	СписокДокументов.Добавить(Метаданные.Документы.CRM_Мероприятие.ПолноеИмя(), Метаданные.Документы.CRM_Мероприятие.Представление(), , БиблиотекаКартинок.Документ);
	//END Кайдашов
КонецПроцедуры // ПолучитьДоступныеТипы() 

&НаКлиенте
// Процедура - обработчик команды формы "ОК".
//
Процедура ОК(Команда)
	Если Элементы.ПанельСписков.ТекущаяСтраница = Элементы.ГруппаДокументов Тогда
		Закрыть(Новый Структура("Значение,Представление", Элементы.СписокДокументов.ТекущиеДанные.Значение, Элементы.СписокДокументов.ТекущиеДанные.Представление));
	ИначеЕсли Элементы.ПанельСписков.ТекущаяСтраница = Элементы.ГруппаСправочников Тогда
		Закрыть(Новый Структура("Значение,Представление", Элементы.СписокСправочников.ТекущиеДанные.Значение, Элементы.СписокСправочников.ТекущиеДанные.Представление));
	КонецЕсли;
КонецПроцедуры // ОК()

&НаСервере
// Процедура - обработчик события формы "ПриСозданииНаСервере".
//
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	ПолучитьДоступныеТипы();
	Если Параметры.Свойство("ВладелецМакета") И НЕ ПустаяСтрока(Параметры.ВладелецМакета) Тогда
		ВладелецМакета	= Параметры.ПредставлениеВладельца;
		ТекущийВладелец	= СписокДокументов.НайтиПоЗначению(ВладелецМакета);
		Если ТекущийВладелец = Неопределено Тогда
			ТекущийВладелец = СписокСправочников.НайтиПоЗначению(ВладелецМакета);
			Если НЕ (ТекущийВладелец = Неопределено) Тогда
				ТекущийЭлемент = Элементы.ГруппаСправочников;
				Элементы.ГруппаСправочников.ПодчиненныеЭлементы.СписокСправочников.ТекущаяСтрока = СписокСправочников.Индекс(ТекущийВладелец);
			КонецЕсли;	
		Иначе	
			ТекущийЭлемент = Элементы.ГруппаДокументов;	
			Элементы.ГруппаДокументов.ПодчиненныеЭлементы.СписокДокументов.ТекущаяСтрока = СписокДокументов.Индекс(ТекущийВладелец);
		КонецЕсли;
	КонецЕсли;	
КонецПроцедуры // ПриСозданииНаСервере()

&НаКлиенте
// Процедура - обработчик события "Выбор" табличного поля формы "СписокДокументов".
//
Процедура СписокДокументовВыбор(Элемент, ВыбраннаяСтрока, Поле, СтандартнаяОбработка)
	Закрыть(Новый Структура("Значение,Представление", Элемент.ТекущиеДанные.Значение, Элемент.ТекущиеДанные.Представление));
КонецПроцедуры // СписокДокументовВыбор()

&НаКлиенте
// Процедура - обработчик события "Выбор" табличного поля формы "СписокСправочников".
//
Процедура СписокСправочниковВыбор(Элемент, ВыбраннаяСтрока, Поле, СтандартнаяОбработка)
	Закрыть(Новый Структура("Значение,Представление", Элемент.ТекущиеДанные.Значение, Элемент.ТекущиеДанные.Представление));
КонецПроцедуры // СписокСправочниковВыбор()


#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если Параметры.Свойство("ПодборИзТелемаркетинга") Тогда
		
		Для Каждого ТекущийОтбор Из Список.Отбор.Элементы Цикл
			Если ТекущийОтбор.ЛевоеЗначение = Новый ПолеКомпоновкиДанных("Ответственный") Тогда
				ТекущийОтбор.Использование	= Ложь;
				Прервать;
			КонецЕсли;	
		КонецЦикла;	
		Для Каждого ТекущийОтбор Из Список.Отбор.Элементы Цикл
			Если ТекущийОтбор.ЛевоеЗначение = Новый ПолеКомпоновкиДанных("СостояниеИнтереса") Тогда
				ТекущийОтбор.Использование	= Ложь;
				Прервать;
			КонецЕсли;	
		КонецЦикла;	
		Если Параметры.Свойство("Партнер") И ЗначениеЗаполнено(Параметры.Партнер) Тогда
			ОтборНайден = Ложь;
			Для Каждого ТекущийОтбор Из Список.Отбор.Элементы Цикл
				Если ТекущийОтбор.ЛевоеЗначение = Новый ПолеКомпоновкиДанных("Партнер") Тогда
					ТекущийОтбор.ВидСравнения	= ВидСравненияКомпоновкиДанных.Равно;
					ТекущийОтбор.ПравоеЗначение	= Параметры.Партнер;
					ТекущийОтбор.Использование	= Истина;
					ОтборНайден = Истина;
					Прервать;
				КонецЕсли;	
			КонецЦикла;	
			Если НЕ ОтборНайден Тогда
				ЭлементОтбора					= Список.Отбор.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
				ЭлементОтбора.ЛевоеЗначение		= Новый ПолеКомпоновкиДанных("Партнер");
				ЭлементОтбора.ВидСравнения		= ВидСравненияКомпоновкиДанных.Равно;
				ЭлементОтбора.ПравоеЗначение	= Параметры.Партнер;
				ЭлементОтбора.Использование		= Истина;
				ЭлементОтбора.РежимОтображения	= РежимОтображенияЭлементаНастройкиКомпоновкиДанных.Обычный;
			КонецЕсли;	
		Иначе
			Для Каждого ТекущийОтбор Из Список.Отбор.Элементы Цикл
				Если ТекущийОтбор.ЛевоеЗначение = Новый ПолеКомпоновкиДанных("Партнер") Тогда
					ТекущийОтбор.Использование	= Ложь;
					Прервать;
				КонецЕсли;	
			КонецЦикла;	
		КонецЕсли;	
		Если Параметры.Свойство("КонтактноеЛицо") И ЗначениеЗаполнено(Параметры.КонтактноеЛицо) Тогда
			ОтборНайден = Ложь;
			Для Каждого ТекущийОтбор Из Список.Отбор.Элементы Цикл
				Если ТекущийОтбор.ЛевоеЗначение = Новый ПолеКомпоновкиДанных("КонтактноеЛицо") Тогда
					ТекущийОтбор.ВидСравнения	= ВидСравненияКомпоновкиДанных.Равно;
					ТекущийОтбор.ПравоеЗначение	= Параметры.КонтактноеЛицо;
					ТекущийОтбор.Использование	= Истина;
					ОтборНайден = Истина;
					Прервать;
				КонецЕсли;	
			КонецЦикла;	
			Если НЕ ОтборНайден Тогда
				ЭлементОтбора					= Список.Отбор.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
				ЭлементОтбора.ЛевоеЗначение		= Новый ПолеКомпоновкиДанных("КонтактноеЛицо");
				ЭлементОтбора.ВидСравнения		= ВидСравненияКомпоновкиДанных.Равно;
				ЭлементОтбора.Использование		= Истина;
				ЭлементОтбора.ПравоеЗначение	= Параметры.КонтактноеЛицо;
				ЭлементОтбора.РежимОтображения	= РежимОтображенияЭлементаНастройкиКомпоновкиДанных.Обычный;
			КонецЕсли;	
		Иначе
			Для Каждого ТекущийОтбор Из Список.Отбор.Элементы Цикл
				Если ТекущийОтбор.ЛевоеЗначение = Новый ПолеКомпоновкиДанных("КонтактноеЛицо") Тогда
					ТекущийОтбор.Использование	= Ложь;
					Прервать;
				КонецЕсли;	
			КонецЦикла;	
		КонецЕсли;
	КонецЕсли;	
	
КонецПроцедуры

#КонецОбласти
